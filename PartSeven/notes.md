### 封装


#### 封装记录

- 动机：能直观的组织起存在关联的数据，可以将数据作为有意义的单元传递
- 做法：
  - 对持有记录的变量使用`封装变量`，将其封装到一个函数中
  - 创建一个类，将记录包装起来，并将记录变量的值替换为该类的一个实例。然后在类上定义一个访问函数，用于返回原始的记录。修改封装变量的函数，令其使用这个访问函数
  - 测试
  - 新建一个函数，让它返回该类的对象，而非那条原始的记录
  - 对于该记录的每个使用点，将原先返回记录的函数调用替换为那个返回实例对象的函数调用。使用对象上的访问函数来获取数据的字段，如果该字段的访问函数还不存在，那就创建一个。每次更改之后运行测试
  - 移除类对原始记录的访问函数，那个容易搜索的返回原始数据的函数也要一并删除
  - 测试
  - 如果记录中的字段本身也是复杂结构，考虑对其再次应用`封装记录`或`封装集合`手法


#### 封装集合

- 动机：封装程序中的所有可变变量，容易清楚数据被修改的地方和修改方式，这样当需要改变数据结构时会非常方便
- 做法：
  - 如果集合的引用尚未封装，先用`封装变量`封装
  - 在类上添加用于操作集合的函数如：添加元素、移除元素
  - 执行静态检查
  - 查找集合的引用点，如果有修改集合的地方，修改为类上的修改函数
  - 修改集合的取值函数，使其返回一份只读的数据，可以使用只读代理或者数据副本
  - 测试