### 重构API



#### 将查询函数和修改函数分离

- 动机：如果一个函数即有返回值，又有副作用，可以进行分离
- 做法：
  - 复制整个函数，将其作为一个查询来命名
  - 从新建的查询函数中去掉所有造成副作用的语句
  - 执行静态检查
  - 查找所有调用原函数的地方。如果调用处用到了该函数的返回值，就将其改为调用新建的查询函数，并在下面马上再调用一次原函数。每次修改之后都要测试
  - 从原函数中去掉返回值
  - 测试